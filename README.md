
# Интеграция рекуператора naveka node1 с пультом Zentec Z031 для Home Assistant

конфигурация для полной интеграции приточно-вытяжной установки naveka node1 с пультом Zentec Z031 в экосистему Home Assistant. Этот проект позволяет не только отслеживать состояние рекуператора, но и полноценно управлять им, используя современный и удобный интерфейс.


![image](https://github.com/user-attachments/assets/d32a6d77-c4e7-4093-a9dc-5849a420242f)


Вся конфигурация упакована в единый файл-пакет для максимально простой установки.

##  Ключевые возможности

  * **Управление по Modbus TCP:** Включение/выключение, установка скорости вентилятора, выбор режима работы и целевой температуры.
  * **Мониторинг:** Отслеживание ключевых температур (в канале, на улице, в помещении), состояния и кодов ошибок.
  * **Готовые сценарии:** Предустановленные режимы "День", "Ночь" и "Проветривание на 15 минут".
  * **Современный интерфейс:** Аккуратная и компактная карточка управления, созданная на базе [Mushroom Cards](https://github.com/piitaya/lovelace-mushroom).
  * **Интеллектуальная синхронизация:** Двусторонняя синхронизация состояния между устройством и интерфейсом Home Assistant.
  * **Простая установка:** Вся логика инкапсулирована в одном файле-пакете.

##  Предварительные требования

1.  Работающий экземпляр **Home Assistant** (версия 2024.x или новее).
2.  Рекуператор **naveka node1 с пультом Zentec Z031**, подключенный к преобразователю RS485 RTU в Wi-Fi. (я использовал USR-DR164) подключеный к выходам RA0 RB0 на контролере.
3.  Установленный **HACS** (Home Assistant Community Store).
4.  Установленные через HACS карты **[Mushroom](https://github.com/piitaya/lovelace-mushroom)**.
    
##  Установка

Установка максимально упрощена благодаря механизму пакетов.
### Шаг 1: Настройка преобразователя (конвектора) 
1. скорость порта: 9600 
2. четность: четные
   
![image](https://github.com/user-attachments/assets/9362ee80-fce7-490d-8e1c-225118e33895)


![image](https://github.com/user-attachments/assets/b89eeebb-8720-435c-b2b5-1513ca9325f3)


### Шаг 2: Настройка `configuration.yaml`

Убедитесь, что ваш главный файл конфигурации `configuration.yaml` настроен на загрузку пакетов. Если нет, добавьте следующую секцию:

```yaml
# configuration.yaml
homeassistant:
  packages: !include_dir_named packages
```

### Шаг 3: Загрузка пакета

1.  Создайте папку `packages` в корневой директории вашей конфигурации Home Assistant (там же, где `configuration.yaml`), если ее еще нет.
2.  Скачайте файл `zentec_recuperator.yaml` из этого репозитория.
3.  Поместите скачанный файл в папку `packages`.

### Шаг 4: Настройка IP-адреса

1.  Откройте файл `packages/zentec_recuperator.yaml`.
2.  Найдите строку `host: 192.168.1.45` и **замените IP-адрес на адрес вашего конвектора modbus**.

### Шаг 5: Перезагрузка Home Assistant

Перезапустите Home Assistant, чтобы он подхватил новую конфигурацию. После перезапуска в системе появятся все необходимые сенсоры, скрипты и автоматизации.

### Шаг 6: Добавление карточки на панель Lovelace

1.  Перейдите на вашу панель управления Lovelace и войдите в режим редактирования.
2.  Добавьте новую "Ручную" карточку и вставьте в нее код из файла `lovelace-card.yaml
   

##  Кастомизация

Вы легко можете адаптировать конфигурацию под свои нужды. Все настройки находятся в файле `zentec_recuperator.yaml`.

  * **Изменение режимов "День" / "Ночь"**: Найдите скрипты `zentec_z031_night_mode` и `zentec_z031_day_mode` и измените значения скорости (`speed`) и температуры (`temperature`) на желаемые.

    ```yaml
    script:
      zentec_z031_night_mode:
        alias: "Zentec Z031: Ночной режим"
        sequence:
          - service: script.zentec_z031_set_all
            data: {state: 1, speed: 1, mode: 2, temperature: 18} # <-- Измените здесь
    ```

  * **Добавление кодов ошибок**: Если вы обнаружите новый код ошибки, просто добавьте его описание в шаблонный сенсор `Zentec Z031 Описание Статуса`.

    ```yaml
    template:
      - sensor:
          - name: "Zentec Z031 Описание Статуса"
            state: >
              {% set errors = {
                "0": "Система в норме",
                "999": "Новая ошибка", # <-- Добавьте сюда
                # ...
              } %}
    ```

##  Вклад

Если у вас есть идеи по улучшению этой конфигурации, не стесняйтесь создавать Issues или Pull Requests.

## Благодарности

  * Команде **Home Assistant** за прекрасную платформу для умного дома.
  * **piitaya** за великолепный набор карт Mushroom.
